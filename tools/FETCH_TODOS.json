{
  "name": "FETCH_TODOS",
  "description": "Fetch all todo items from the database, sorted by priority and date",
  "inputSchema": {
    "type": "object",
    "properties": {
      "include_completed": {
        "type": "boolean",
        "default": true,
        "description": "Whether to include completed tasks"
      }
    },
    "additionalProperties": false
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "tasks": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "priority": {
              "type": "string",
              "enum": [
                "low",
                "medium",
                "high"
              ]
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "completed": {
              "type": "boolean"
            },
            "created_at": {
              "type": "string"
            },
            "updated_at": {
              "type": "string"
            }
          }
        }
      },
      "total": {
        "type": "number"
      }
    },
    "required": [
      "tasks",
      "total"
    ],
    "additionalProperties": false
  },
  "execute": "export default async function(input, ctx) {\n  const { include_completed = true } = input;\n  \n  let sql = `SELECT id, description, priority, tags, completed, created_at, updated_at FROM todo_items`;\n  if (!include_completed) sql += ` WHERE completed = 0`;\n  sql += ` ORDER BY CASE WHEN priority = 'high' THEN 0 WHEN priority = 'medium' THEN 1 ELSE 2 END, completed ASC, created_at DESC`;\n  \n  const result = await ctx.env['i:databases-management'].DATABASES_RUN_SQL({sql});\n  \n  if (!result.result[0] || !result.result[0].results) {\n    return { tasks: [], total: 0 };\n  }\n  \n  const tasks = result.result[0].results.map(row => ({\n    ...row,\n    tags: typeof row.tags === 'string' ? JSON.parse(row.tags || '[]') : (row.tags || []),\n    completed: row.completed === 1 || row.completed === true\n  }));\n  \n  return { tasks, total: tasks.length };\n}",
  "dependencies": [
    {
      "integrationId": "i:databases-management",
      "toolNames": [
        "DATABASES_RUN_SQL"
      ]
    }
  ]
}